@use "sass:list"

@use "../utilities/derived-variables" as vars
@use "../utilities"

$tag-background-color: var(--scheme-main-bis) !default
$tag-color: var(--text) !default
$tag-radius: var(--radius) !default
$tag-delete-margin: 1px !default
$tag-font-size: var(--size-small) !default
$tag-focus-background-color: var(--scheme-main-ter) !default
$tag-active-background-color: var(--scheme-main-ter) !default

$tag-colors: vars.$colors !default

// Map Local variables
$-css-vars-map: ('tag-background-color': $tag-background-color, 'tag-color': $tag-color, 'tag-radius': $tag-radius, 'tag-font-size': $tag-font-size, 'tag-delete-margin': $tag-delete-margin, 'tag-focus-background-color': $tag-focus-background-color, 'tag-active-background-color': $tag-active-background-color)
+utilities.exportCSSVars($-css-vars-map)
+utilities.registerComponentCSSVars(('tag', 'tags'), $-css-vars-map)
// --tag-background-color: #{$tag-background-color}
// --tag-color: #{$tag-color}
// --tag-radius: #{$tag-radius}
// --tag-font-size: #{$tag-font-size}
// --tag-delete-margin: #{$tag-delete-margin}

.tags
  align-items: center
  display: flex
  flex-wrap: wrap
  justify-content: flex-start
  .tag
    +utilities.logical-y(margin, 0.5rem, $bottom: true)
    &:not(:last-child)
      +utilities.logical-x(margin, 0.5rem, $right: true)
  &:last-child
    +utilities.logical-y(margin, -0.5rem, $bottom: true)
  &:not(:last-child)
    +utilities.logical-y(margin, 1rem, $bottom: true)
  // Sizes
  &.are-medium
    .tag:not(.is-normal, .is-large)
      --tag-font-size: var(--size-normal)
  &.are-large
    .tag:not(.is-normal, .is-medium)
      --tag-font-size: var(--size-medium)
  &.is-centered
    justify-content: center
    .tag
      +utilities.logical-x(margin, 0.25rem)
  &:is(.is-right, .is-end)
    justify-content: flex-end
    .tag
      &:not(:first-child)
        +utilities.logical-x(margin, 0.5rem, $right: false)
      &:not(:last-child)
        +utilities.logical-x(margin, 0, $right: true)
  &.has-addons
    .tag
      +utilities.logical-x(margin, 0, $right: true)
      &:not(:first-child)
        +utilities.logical-x(margin, 0, $right: false)
        +utilities.logical-border-radius(left, 0)
      &:not(:last-child)
        +utilities.logical-border-radius(right, 0)

.tag:not(body)
  align-items: center
  background-color: var(--tag-background-color)
  border-radius: var(--tag-radius)
  color: var(--tag-color)
  display: inline-flex
  font-size: var(--tag-font-size)
  height: 2em
  justify-content: center
  line-height: 1.5
  +utilities.logical-x(padding, 0.75em)
  white-space: nowrap
  .delete
    +utilities.logical-x(margin, 0.25rem, $right: false)
    +utilities.logical-x(margin, -0.375rem, $right: true)
  // Colors
  @each $name, $pair in $tag-colors
    &.is-#{$name}
      background-color: var(--#{$name})
      color: var(--#{$name}-invert)
      // If a light and dark colors are provided
      @if list.length($pair) > 3
        &.is-light
          background-color: var(--#{$name}-light)
          color: var(--#{$name}-dark)
  // Sizes
  +utilities.control-sizes(tag-font-size)
  .icon
    &:first-child:not(:last-child)
      +utilities.logical-x(margin, -0.375em, $right: false)
      +utilities.logical-x(margin, 0.1875em, $right: true)
    &:last-child:not(:first-child)
      +utilities.logical-x(margin, 0.1875em, $right: false)
      +utilities.logical-x(margin, -0.375em, $right: true)
    &:first-child:last-child
      +utilities.logical-x(margin, -0.375em)
  // Modifiers
  &.is-delete
    +utilities.logical-x(margin, var(--tag-delete-margin), $right: false)
    padding: 0
    position: relative
    width: 2em
    &::before,
    &::after
      background-color: currentColor
      content: ""
      display: block
      +utilities.logical-x(inset, 50%, $right: false)
      position: absolute
      top: 50%
      transform: translateX(-50%) translateY(-50%) rotate(45deg)
      transform-origin: center center
    &::before
      height: 1px
      width: 50%
    &::after
      height: 50%
      width: 1px
    &:is(:hover, :focus)
      background-color: var(--tag-focus-background-color)
    &:active
      background-color: var(--tag-active-background-color)
  &.is-rounded
    border-radius: var(--radius-rounded)

a.tag
  &:hover
    text-decoration: underline
